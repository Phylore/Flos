<!DOCTYPE html>
<html>
<head>
    <title>ğŸ“¦ Einpacken â€“ {{ geraet.qrcode }}</title>
</head>
<body>
    <h1>ğŸ“¦ Einpacken: {{ geraet.modell.name }} ({{ geraet.qrcode }})</h1>

    <h2>âœ… Vorbereitungs-Check</h2>
    <ul>
        <li>ğŸ“¦ Auspacken: 
            {% if geraet.ausgepackt %}âœ…{% else %}âŒ{% endif %}
        </li>
        <li>ğŸ§½ Reinigung: 
            {% if geraet.gereinigt %}âœ…{% else %}âŒ{% endif %}
        </li>
        <li>ğŸ§ª Funktionstest: 
            {% if geraet.getestet %}âœ…{% else %}âŒ{% endif %}
        </li>
        <li>ğŸ“¸ Bilder: 
            {% if geraet.bilder_einpackfertig %}âœ…{% else %}âŒ{% endif %}
        </li>
    </ul>

    <h2>ğŸ“¦ Ersatzteilpaket auswÃ¤hlen</h2>

    <form method="post">
        <label for="ersatzpaket">Paket:</label>
        <select name="ersatzpaket" id="ersatzpaket" required>
            <option value="" disabled selected>-- WÃ¤hle ein Paket --</option>
            {% for paket in ersatzpakete %}
                <option value="{{ paket }}">{{ paket }}</option>
            {% else %}
                <option disabled>âŒ Keine Pakete verfÃ¼gbar</option>
            {% endfor %}
        </select>

        <h3>ğŸ“‹ Enthaltene Teile:</h3>
        <ul id="teilListe">
            <li><em>Bitte ein Paket auswÃ¤hlen</em></li>
        </ul>

        <br><br>
        <button type="submit">ğŸ“¦ Einpacken abschlieÃŸen</button>
    </form>

    <br>
    <a href="{{ url_for('geraete.geraet_seite', qrcode=geraet.qrcode) }}">ğŸ”™ ZurÃ¼ck zum GerÃ¤t</a>

    <script>
        const ersatzteile = {{ ersatzpaket_inhalt_json | safe }};

        document.getElementById("ersatzpaket").addEventListener("change", function () {
            const selected = this.value;
            const teile = ersatzteile[selected] || [];

            const liste = document.getElementById("teilListe");
            liste.innerHTML = "";

            if (teile.length === 0) {
                liste.innerHTML = "<li><em>Keine Teile definiert</em></li>";
            } else {
                teile.forEach(name => {
                    const li = document.createElement("li");
                    li.textContent = name;
                    liste.appendChild(li);
                });
            }
        });
    </script>
</body>
</html>

