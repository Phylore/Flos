<!DOCTYPE html>
<html>
<head>
    <title>ğŸ“¦ Einpacken â€“ {{ geraet.qrcode }}</title>
    <style>
        #paketinhalt {
            margin-top: 1em;
            padding-left: 1em;
        }
    </style>
</head>
<body>
    <h1>ğŸ“¦ Einpacken: {{ geraet.modell.name }} ({{ geraet.qrcode }})</h1>

    <h2>âœ… Vorbereitungs-Check</h2>
    <ul>
        <li>ğŸ“¦ Auspacken: 
            {% if status.auspacken %}âœ…{% else %}âŒ{% endif %}
        </li>
        <li>ğŸ§½ Reinigung: 
            {% if status.reinigung %}âœ…{% else %}âŒ{% endif %}
        </li>
        <li>ğŸ§ª Funktionstest: 
            {% if status.funktion %}âœ…{% else %}âŒ{% endif %}
        </li>
    </ul>

    <h2>ğŸ“¦ Ersatzteilpaket auswÃ¤hlen</h2>

    <form method="post">
        <label for="ersatzpaket">Paket:</label>
        <select name="ersatzpaket" id="ersatzpaket" required>
            <option value="" disabled selected>-- WÃ¤hle ein Paket --</option>
            {% for paket in ersatzpakete %}
                <option value="{{ paket }}">{{ paket }}</option>
            {% else %}
                <option disabled>âŒ Keine Pakete verfÃ¼gbar</option>
            {% endfor %}
        </select>

        <div id="paketinhalt">
            <!-- Dynamische Anzeige der Paketinhalte -->
        </div>

        <br>
        <button type="submit">ğŸ“¦ Einpacken abschlieÃŸen</button>
    </form>

    <br>
    <a href="{{ url_for('geraete.geraet_seite', qrcode=geraet.qrcode) }}">ğŸ”™ ZurÃ¼ck zum GerÃ¤t</a>

    <script>
        const ersatzteilSetNamen = {
            "Saugroboter-Ersatzteile-Standard1": [
                "Staubbeutel",
                "SeitenbÃ¼rste",
                "Filter fÃ¼r Staubbeutel",
                "Wischpad", "Wischpad", "Wischpad", "Wischpad"
            ],
            "Ersatzbox-Premium": [
                "Staubbeutel", "Staubbeutel",
                "SeitenbÃ¼rste", "SeitenbÃ¼rste",
                "Filter fÃ¼r Staubbeutel", "Filter fÃ¼r Staubbeutel",
                "Wischpad", "Wischpad", "Wischpad", "Wischpad"
            ]
        };

        document.getElementById('ersatzpaket').addEventListener('change', function () {
            const inhaltDiv = document.getElementById('paketinhalt');
            const selected = this.value;
            const teile = ersatzteilSetNamen[selected] || [];
            const grouped = {};

            // Gruppieren nach Menge
            teile.forEach(t => grouped[t] = (grouped[t] || 0) + 1);

            let html = '<h3>ğŸ“‹ Inhalt des Pakets:</h3><ul>';
            for (const [teil, anzahl] of Object.entries(grouped)) {
                html += `<li>${anzahl}Ã— ${teil}</li>`;
            }
            html += '</ul>';

            inhaltDiv.innerHTML = html;
        });
    </script>
</body>
</html>

